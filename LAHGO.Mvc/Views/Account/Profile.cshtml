@model MemberVM
@{
    ViewData["Title"] = "Profile";
    var no = 0;
}

@await Component.InvokeAsync("DetailHeader")

<section id="section1-myaccount">
    <div class="section-title text-center">
        Welcome back, <span class="username">@Model.ProfileVM.FullName</span>
    </div>
    <div class="account-options-mobile">
        <div class="account-option-button section-describtion">
            Dashboard
        </div>
        <ul class="">
            <li class="account-option-mobile"><a href="#account1-middle">Dashboard</a></li>
            <li class="account-option-mobile"><a asp-controller="basket" asp-action="index">Wishlist</a></li>
            <li class="account-option-mobile"><a asp-controller="contact" asp-action="index">Customer Help</a></li>
            <li class="account-option-mobile section-describtion-small account-options-button account-details"><a href="#account-details">Account Details</a></li>
            <li class="account-option-mobile"><a asp-controller="account" asp-action="logout">Logout</a></li>
        </ul>
    </div>
    <div class="ccontainer row g-0">
        <div class="account1-left col-lg-3">
            <div class="section-describtion">Account</div>
            <ul>
                <li class="account-option account-options-button section-describtion-small">
                    <a href="#account1-middle">Dashboard</a>
                </li>
                <li class="account-option account-options-button section-describtion-small">
                    <a asp-controller="basket" asp-action="index">Wishlist</a>
                </li>
                <li class="account-option account-options-button section-describtion-small">
                    <a asp-controller="contact" asp-action="index">Customer Help</a>
                </li>
                <li class="section-describtion-small account-options-button account-details">
                    <a href="#account-details">Account Details</a>
                </li>
                <li class="account-option account-options-button section-describtion-small">
                    <a asp-controller="account" asp-action="logout">Logout</a>
                </li>
            </ul>
        </div>

        <div id="account1-middle" class="account1-middle col-lg-7">
            @if (Model.Orders.Count() == 0)
            {
                <div class="empty-order section-describtion-small">
                    You haven’t placed any orders yet. Check back after placing an order to view details here.
                </div>
            }
            else
            {
                <div class="col-lg-12 col-md-8">
                    <div class="tab-content" id="myaccountContent">
                        <!-- Single Tab Content Start -->
                        <div class="" id="orders" role="tabpanel">
                            <div class="myaccount-content">
                                <h3>Orders</h3>
                                <div class="myaccount-table table-responsive text-center">
                                    <table class="table table-condensed table-striped">
                                        <thead>
                                            <tr>
                                                <th></th>
                                                <th>Order</th>
                                                <th>Customer Name</th>
                                                <th>Date</th>
                                                <th>Status</th>
                                                <th>Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (Order order in Model.Orders)
                                            {
                                                no++;
                                                int itemNo = 0;
                                                <tr data-toggle="collapse" data-target="#demo@(order.Id)" class="accordion-toggle">
                                                    <td><button class="btn btn-default btn-xs"><span class="glyphicon glyphicon-eye-open"></span></button></td>
                                                    <td>@no</td>
                                                    <td>@order.FullName</td>
                                                    <td>@order.CreatedAt?.ToString("dd-MM-yyyy")</td>
                                                    <td>@order.OrderStatus</td>
                                                    <td>$@order.TotalPrice</td>
                                                </tr>
                                                <tr>
                                                    <td colspan="6" class="hiddenRow">
                                                        <div class="accordian-body collapse" id="demo@(order.Id)">
                                                            <table class="table table-striped table-dark">
                                                                <thead>
                                                                    <tr class="info">
                                                                        <th class="col-lg-1"></th>
                                                                        <th class="col-lg-3">Image</th>
                                                                        <th class="col-lg-3">Product Name</th>
                                                                        <th class="col-lg-2">Product Price</th>
                                                                        <th class="col-lg-1">Count</th>
                                                                        <th class="col-lg-2">Subtotal</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @foreach (OrderItem orderItem in order.OrderItems)
                                                                    {
                                                                        itemNo++;
                                                                        <tr data-toggle="collapse" class="accordion-toggle">
                                                                            <td class="col-lg-1">@itemNo</td>
                                                                            <td class="col-lg-3">
                                                                                <img class="img-fluid" src="~/Manage/assets/img/productMainImg/@orderItem.Image" alt="Alternate Text" />
                                                                            </td>
                                                                            <td class="col-lg-3">@orderItem.Product.Name</td>
                                                                            <td class="col-lg-2">$@orderItem.Price</td>
                                                                            <td class="col-lg-1">@orderItem.Count</td>
                                                                            <td class="col-lg-2">$@orderItem.TotalPrice</td>
                                                                        </tr>
                                                                    }
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                    
                                </div>
                            </div>
                        </div>
                        <!-- Single Tab Content End -->
                    </div>
                </div> <!-- My Account Tab Content End -->
            }

        </div>
        <div id="account-details" class=" col-lg-6">
            @await Html.PartialAsync("_ProfileUpdatePartial", Model.ProfileVM) 
        </div>
        <div class="account1-right col-lg-4">

        </div>
    </div>
</section>
